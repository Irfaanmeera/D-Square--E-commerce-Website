{{> userHeader}}

<div class="container">
  <div
    class="bg-white rounded d-flex align-items-center justify-content-between"
    id="header"
  >
    <button
      class="btn btn-hide text-uppercase"
      type="button"
      data-toggle="collapse"
      data-target="#filterbar"
      aria-expanded="false"
      aria-controls="filterbar"
      id="filter-btn"
      onclick="changeBtnTxt()"
    >
      <span class="fas fa-angle-left" id="filter-angle"></span>
      <span id="btn-txt">Hide filters</span>
    </button>
    <nav class="navbar navbar-expand-lg navbar-light pl-lg-0 pl-auto">
      <button
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#mynav"
        aria-controls="mynav"
        aria-expanded="false"
        aria-label="Toggle navigation"
        onclick="chnageIcon()"
        id="icon"
      > <span class="navbar-toggler-icon"></span> </button>
      <div class="collapse navbar-collapse" id="mynav">
        <ul class="navbar-nav d-lg-flex align-items-lg-center">
          <li class="nav-item active">
            <select name="sort" id="sort">
              <option value="" hidden selected>Sort by</option>
              <option value="price">Price</option>
              <option value="popularity">Popularity</option>
              <option value="rating">Rating</option>
            </select>
          </li>
          <li
            class="nav-item d-inline-flex align-items-center justify-content-between mb-lg-0 mb-3"
          >
            <div class="d-inline-flex align-items-center mx-lg-2" id="select2">
              <div class="pl-2">Products:</div>
              <select name="pro" id="pro">
                <option value="18">18</option>
                <option value="19">19</option>
                <option value="20">20</option>
              </select>
            </div>
            <div class="font-weight-bold mx-2 result">18 from 200</div>
          </li>
          <li class="nav-item d-lg-none d-inline-flex"> </li>
        </ul>
      </div>
    </nav>
    <div class="ml-auto mt-3 mr-2">
      <nav aria-label="Page navigation example">
        <ul class="pagination">
          <li class="page-item">
            <a class="page-link" href="#" aria-label="Previous">
              <span aria-hidden="true" class="font-weight-bold">&lt;</span>
              <span class="sr-only">Previous</span>
            </a>
          </li>
          <li class="page-item active"><a class="page-link" href="#">1</a></li>
          <li class="page-item"><a class="page-link" href="#">..</a></li>
          <li class="page-item"><a class="page-link" href="#">24</a></li>
          <li class="page-item">
            <a class="page-link" href="#" aria-label="Next">
              <span aria-hidden="true" class="font-weight-bold">&gt;</span>
              <span class="sr-only">Next</span>
            </a>
          </li>
        </ul>
      </nav>
    </div>
  </div>
  <div id="content" class="my-5">
    <div id="filterbar" class="collapse">
      <div class="box border-bottom">
        <div class="form-group text-center">
          <div class="btn-group" data-toggle="buttons">
            <button onclick="resetShopPage()" class="btn btn- block btn-primary">
            <label >  
              Reset
            </label>
            </button>
           
          </div>
        </div>
     </div>
      <div class="box border-bottom">
        <div class="box-label text-uppercase d-flex align-items-center"
        >Category
          <button
            class="btn ms-auto"
            type="button"
            data-toggle="collapse"
            data-target="#inner-box"
            aria-expanded="false"
            aria-controls="inner-box"
            id="out"
            onclick="outerFilter()"
          > <span class="fas fa-plus"></span> </button>
        </div>
        <div id="inner-box" class="collapse mt-2 mr-1">
          {{#each categoryData}}
          <div class="my-1">
            <a href="/filterCategory/{{this.categoryName}}"> 
            <label class="tick ">{{this.categoryName}}
            </label></a>
           
          </div>
          {{/each}}
     
        </div>
      </div>
     
      <div class="box border-bottom">
        <div class="box-label text-uppercase d-flex align-items-center">Brand
          <button
            class="btn ms-auto"
            type="button"
            data-toggle="collapse"
            data-target="#inner-box2"
            aria-expanded="false"
            aria-controls="inner-box2"
          ><span class="fas fa-plus"></span></button>
        </div>
        <div id="inner-box2" class="collapse mt-2 mr-1">
          {{#each productData}}
          <div class="my-1">
            <a href="/filterBrand/{{this.brand}}"> 
            <label class="tick">{{this.brand}}
            </label></a>
          </div>
          {{/each}}
      
      
          
        </div>
      </div>
      <div class="box border-bottom">
        <div class="box-label text-uppercase d-flex align-items-center">price
          <button
            class="btn ms-auto"
            type="button"
            data-toggle="collapse"
            data-target="#price"
            aria-expanded="false"
            aria-controls="price"
          ><span class="fas fa-plus"></span></button>
        </div>
        
 <div class="collapse mb-5" id="price">
        <div class="middle">
           
<!-- Your form goes here -->
  <form id="priceRangeForm" action="/filterPriceRange" method="get">
    <div>
        <label for="priceRange">Price Range:</label>
        <!-- Hidden input fields to store selected price range values -->
        <input type="hidden" id="minPrice" name="minPrice">
        <input type="hidden" id="maxPrice" name="maxPrice">
        <!-- Slider container -->
        <input type="text" id="priceRangeSlider">
    </div>
    <button class="btn btn-primary" type="submit">Filter</button>
</form>


<!-- Script to initialize the slider -->

      </div>
      </div>
        
    </div>

      </div>
      
    </div>
    
        <div class="container ">
        <div class="row">
           {{#each productData}}
          <div class="col-md-4 col-sm-12">
            <!-- Start Single Product -->
            
            <div class="single-product ">
              <div class="product-image">
                <a href="/productDetails/{{this._id}}">
                <img style="width:150px;height:200px; margin-left:27px;" src="/images/productImages/{{this.productImage1}}" alt="Product Image" /></a>
            
               
              </div>
              
              <div class="product-info">
                
                <h4 class="title">
                  <a href="/productDetails/{{this._id}}">{{this.productName}}</a>
                </h4>
                <ul class="review">
                  <li><i class="lni lni-star-filled"></i></li>
                  <li><i class="lni lni-star-filled"></i></li>
                  <li><i class="lni lni-star-filled"></i></li>
                  <li><i class="lni lni-star-filled"></i></li>
                  <li><i class="lni lni-star"></i></li>
                  <li><span>4.0 Review(s)</span></li>
                </ul>
                <div class="price">
                  <span>â‚¹ {{this.productPrice}}</span>
                <i class="fa-regular fa-heart" style="color: #1f59ea; margin-left:80px;"></i>
                </div>
              </div>
            
            </div>
           
            <!-- End Single Product -->
            
          </div>
          {{/each}} 
            <!-- End Single Product -->
             
          </div>
         
        </div>  
  </div>
</div>

<script src="https://use.fontawesome.com/releases/v5.7.2/css/all.css" ></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" ></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.bundle.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"></script>
{{!-- filters --}}
<script>
document.addEventListener("DOMContentLoaded", function() {
    var filterBtn = document.getElementById('filter-btn');
    var btnTxt = document.getElementById('btn-txt');
    var filterAngle = document.getElementById('filter-angle');
    
    $('#filterbar').collapse(false);
    var count = 0, count2 = 0;
    function changeBtnTxt() {
    $('#filterbar').collapse(true);
    count++;
    if (count % 2 != 0) {
    filterAngle.classList.add("fa-angle-right");
    btnTxt.innerText = "show filters"
    filterBtn.style.backgroundColor = "#36a31b";
    }
    else {
    filterAngle.classList.remove("fa-angle-right")
    btnTxt.innerText = "hide filters"
    filterBtn.style.backgroundColor = "#ff935d";
    }
    
    }
    
    // For Applying Filters
    $('#inner-box').collapse(true);
    $('#inner-box2').collapse(false);
    
    // For changing NavBar-Toggler-Icon
    var icon = document.getElementById('icon');
    
    function chnageIcon() {
    count2++;
    if (count2 % 2 != 0) {
    icon.innerText = "";
    icon.innerHTML = '<span class="far fa-times-circle" style="width:100%"></span>';
    icon.style.paddingTop = "5px";
    icon.style.paddingBottom = "5px";
    icon.style.fontSize = "1.8rem";
    
    
    }
    else {
    icon.innerText = "";
    icon.innerHTML = '<span class="navbar-toggler-icon"></span>';
    icon.style.paddingTop = "5px";
    icon.style.paddingBottom = "5px";
    icon.style.fontSize = "1.2rem";
    }
    }
    
    // Showing tooltip for AVAILABLE COLORS
    $(function () {
    $('[data-tooltip="tooltip"]').tooltip()
    })
    
    // For Range Sliders
    /*
    var inputLeft = document.getElementById("input-left");
    var inputRight = document.getElementById("input-right");
    
    var thumbLeft = document.querySelector(".slider > .thumb.left");
    var thumbRight = document.querySelector(".slider > .thumb.right");
    var range = document.querySelector(".slider > .range");
    
    var amountLeft = document.getElementById('amount-left')
    var amountRight = document.getElementById('amount-right')
    
    function setLeftValue() {
    var _this = inputLeft,
    min = parseInt(_this.min),
    max = parseInt(_this.max);
    
    _this.value = Math.min(parseInt(_this.value), parseInt(inputRight.value) - 1);
    
    var percent = ((_this.value - min) / (max - min)) * 100;
    
    thumbLeft.style.left = percent + "%";
    range.style.left = percent + "%";
    amountLeft.innerText = parseInt(percent * 100);
    }
    setLeftValue();
    
    function setRightValue() {
    var _this = inputRight,
    min = parseInt(_this.min),
    max = parseInt(_this.max);
    
    _this.value = Math.max(parseInt(_this.value), parseInt(inputLeft.value) + 1);
    
    var percent = ((_this.value - min) / (max - min)) * 100;
    
    amountRight.innerText = parseInt(percent * 100);
    thumbRight.style.right = (100 - percent) + "%";
    range.style.right = (100 - percent) + "%";
    }
    setRightValue();
    
    inputLeft.addEventListener("input", setLeftValue);
    inputRight.addEventListener("input", setRightValue);
    
    inputLeft.addEventListener("mouseover", function () {
    thumbLeft.classList.add("hover");
    });
    inputLeft.addEventListener("mouseout", function () {
    thumbLeft.classList.remove("hover");
    });
    inputLeft.addEventListener("mousedown", function () {
    thumbLeft.classList.add("active");
    });
    inputLeft.addEventListener("mouseup", function () {
    thumbLeft.classList.remove("active");
    });
    
    inputRight.addEventListener("mouseover", function () {
    thumbRight.classList.add("hover");
    });
    inputRight.addEventListener("mouseout", function () {
    thumbRight.classList.remove("hover");
    });
    inputRight.addEventListener("mousedown", function () {
    thumbRight.classList.add("active");
    });
    inputRight.addEventListener("mouseup", function () {
    thumbRight.classList.remove("active");
    });*/
    });
    </script>


{{!-- reset shop page --}}
    <script>
    function resetShopPage() {
        // Clear any applied filters (e.g., by removing query parameters from the URL)
        // Reload the page
        window.location.href = "/shop";
    }
</script>

<!-- Include ion.rangeSlider CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ion-rangeslider/2.3.1/css/ion.rangeSlider.min.css"/>

<!-- Include jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<!-- Include ion.rangeSlider JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/ion-rangeslider/2.3.1/js/ion.rangeSlider.min.js"></script>

<!-- JavaScript to initialize the slider -->
<script>
$(document).ready(function() {
    $("#priceRangeSlider").ionRangeSlider({
        type: "double",
        grid: true,
        min: 0,
        max: 10000,
        from: 2000,
        to: 8000,
        step: 100,
        prefix: "â‚¹",
        onFinish: function (data) {
            // Log the selected range to the console for debugging
            console.log("Selected Range: " + data.from + " to " + data.to);

            // Update the values of the hidden input fields with the selected range
            $("#minPrice").val(data.from);
            $("#maxPrice").val(data.to);
        }
    });
});

</script>

{{> userFooter}}